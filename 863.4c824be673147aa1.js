"use strict";(self.webpackChunkfrontend_practice=self.webpackChunkfrontend_practice||[]).push([[863],{6863:(Oe,b,_)=>{_.r(b),_.d(b,{TopicsContainerModule:()=>Ee});var m=_(6814),r=_(95),g=_(228),d=_(7944),e=_(4946),A=_(5409),C=_(2115);function N(n,o){1&n&&(e.ynx(0),e.TgZ(1,"div",3)(2,"a",4),e._uU(3,"Crear tema"),e.qZA()(),e.TgZ(4,"div",3)(5,"a",5),e._uU(6,"Crear subtema"),e.qZA()(),e.BQk())}function S(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h6"),e._uU(2,"Subtemas"),e.qZA(),e.BQk())}function U(n,o){1&n&&(e.TgZ(0,"h6"),e._uU(1,"No hay subtemas"),e.qZA())}function J(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"a",12)(2,"div",7)(3,"h5",8),e._uU(4),e.qZA()(),e.TgZ(5,"p",8),e._uU(6),e.ALo(7,"slice"),e.qZA()(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("routerLink","subtopic-show/"+t._id),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description.length>50?e.Dn7(7,3,t.description,0,50)+"...":t.description)}}function F(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"a",6)(2,"div",7)(3,"h5",8),e._uU(4),e.qZA()(),e.TgZ(5,"p",8),e._uU(6),e.ALo(7,"slice"),e.qZA()(),e.TgZ(8,"div",9),e.YNc(9,S,3,0,"ng-container",10),e.YNc(10,U,2,0,"ng-template",null,11,e.W1O),e.qZA(),e.YNc(12,J,8,7,"ng-container",2),e.BQk()),2&n){const t=o.$implicit,i=e.MAs(11);e.xp6(1),e.Q6J("routerLink","topic-show/"+t._id),e.xp6(3),e.hij("Tema: ",t.name,""),e.xp6(2),e.Oqu(t.description.length>50?e.Dn7(7,6,t.description,0,50)+"...":t.description),e.xp6(3),e.Q6J("ngIf",t.subtopics.length)("ngIfElse",i),e.xp6(3),e.Q6J("ngForOf",t.subtopics)}}const k=function(n){return[n]};let I=(()=>{class n{constructor(t,i){this.authenticatedService=t,this.topicHttpService=i,this.userType=d.F,this.topicData=[]}ngOnInit(){this.internalInit()}internalInit(){this.retrieveTopics()}retrieveTopics(){this.topicHttpService.retrieveTopics().subscribe({next:t=>{this.topicData=t.data},error:t=>{console.log(t)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(A.c),e.Y36(C.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["topics-container"]],decls:3,vars:4,consts:[[4,"ngIf"],[1,"list-group"],[4,"ngFor","ngForOf"],[1,"mb-3"],["routerLink","topic-create",1,"btn","btn-primary"],["routerLink","subtopic-create",1,"btn","btn-light"],["aria-current","true",1,"list-group-item","list-group-item-action","active",3,"routerLink"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"list-group-item","list-group-item-action"],[4,"ngIf","ngIfElse"],["noSubtopics",""],[1,"list-group-item","list-group-item-action",3,"routerLink"]],template:function(t,i){1&t&&(e.YNc(0,N,7,0,"ng-container",0),e.TgZ(1,"div",1),e.YNc(2,F,13,10,"ng-container",2),e.qZA()),2&t&&(e.Q6J("ngIf",i.authenticatedService.hasRole(e.VKq(2,k,i.userType.ADMIN))),e.xp6(2),e.Q6J("ngForOf",i.topicData))},dependencies:[m.sg,m.O5,g.rH,m.OU],encapsulation:2}),n})();var f=(()=>((f=f||{}).OPEN="Open",f.CLOSED="Closed",f))(),T=_(8994),u=(()=>((u=u||{}).IMAGE="image",u.VIDEO="video",u.UNKNOWN="unknown",u))();let x=(()=>{class n{constructor(){}getMediaTypeFromBase64(t){return t.startsWith("data:image")?u.IMAGE:t.startsWith("data:video")?u.VIDEO:u.UNKNOWN}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function E(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2,"Crear tema"),e.qZA(),e.BQk())}function O(n,o){1&n&&(e.TgZ(0,"h1"),e._uU(1,"Crear subtema"),e.qZA())}function Y(n,o){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Ingresa el nombre"),e.qZA())}function B(n,o){1&n&&(e.TgZ(0,"p",20),e._uU(1," Ingresa la descripci\xf3n"),e.qZA())}function M(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"option",21),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function L(n,o){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Por favor Selecciona un estado"),e.qZA())}function H(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"option",21),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function R(n,o){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Porfavor Selecciona el tema"),e.qZA())}function G(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",9)(2,"label",22),e._uU(3,"Tema"),e.qZA(),e.TgZ(4,"select",23)(5,"option",12),e._uU(6,"Selecciona el tema"),e.qZA(),e.YNc(7,H,3,2,"ng-container",13),e.qZA(),e.YNc(8,R,2,0,"p",6),e._UZ(9,"br"),e.qZA(),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(7),e.Q6J("ngForOf",t.topics),e.xp6(1),e.Q6J("ngIf",(null==(i=t.form.get("topic"))?null:i.invalid)&&((null==(i=t.form.get("topic"))?null:i.dirty)||(null==(i=t.form.get("topic"))?null:i.touched)))}}function D(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"img",24),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("src",t.file,e.LSH)}}function V(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"video",25),e._UZ(2,"source",26),e._uU(3," Tu navegador no admite la reproducci\xf3n de video. "),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("src",t.file,e.LSH)}}function P(n,o){if(1&n&&(e.ynx(0),e.YNc(1,D,2,1,"ng-container",14),e.YNc(2,V,4,1,"ng-container",14),e._UZ(3,"br"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.fileMediaType===t.mediaTypeEnum.IMAGE),e.xp6(1),e.Q6J("ngIf",t.fileMediaType===t.mediaTypeEnum.VIDEO)}}function K(n,o){1&n&&(e.TgZ(0,"p",20),e._uU(1," Selecciona el archivo"),e.qZA())}let Z=(()=>{class n{constructor(t,i,c){this.topicHttpService=t,this.mediaService=i,this.router=c,this.resourceTypeEnum=T._,this.mediaTypeEnum=u,this.form=new r.cw({}),this.statusList=[],this.resourceType=T._.TOPIC,this.topics=[],this.file="",this.fileMediaType=u.UNKNOWN}ngOnInit(){this.internalInit()}validate(){this.form.valid?this.register():alert("form invalid")}onFileChange(t){t.target.files&&t.target.files.length>0&&this.convertToBase64(t.target.files[0])}convertToBase64(t){const i=new FileReader;i.onload=()=>{this.file=i.result,this.fileMediaType=this.mediaService.getMediaTypeFromBase64(this.file)},i.readAsDataURL(t)}internalInit(){this.setStatusList(),this.setResourceType(),this.retrieveTopics(),this.buildForm()}setStatusList(){this.statusList=[],Object.values(f).forEach(t=>{this.statusList.push(t)})}setResourceType(){this.resourceType=this.router.url.split("/").pop()?.split("-")[0]}buildForm(){this.form=new r.cw({name:new r.NI("",[r.kI.required]),description:new r.NI("",[r.kI.required]),status:new r.NI(f.OPEN,[r.kI.required]),file:new r.NI("",[r.kI.required])}),this.resourceType===this.resourceTypeEnum.SUBTOPIC&&this.form.addControl("topic",new r.NI("",[r.kI.required]))}retrieveTopics(){this.resourceType===this.resourceTypeEnum.SUBTOPIC&&this.topicHttpService.retrieveTopics().subscribe({next:t=>{this.topics=t.data},error:t=>{console.error(t)}})}buildRequest(){return{...this.form.value,files:this.file}}register(){const t=this.buildRequest();this.topicHttpService.registerResource(t,this.resourceType).subscribe({next:i=>{this.handleRegisterSuccess(i)},error:i=>{console.log("err",i)}})}handleRegisterSuccess(t){this.form.reset(),this.router.navigate(["/topics"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.J),e.Y36(x),e.Y36(g.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["topic-create-container"]],decls:34,vars:10,consts:[[4,"ngIf","ngIfElse"],["subtopicTemplate",""],[1,"row",3,"formGroup"],[1,"col-12","mb-3"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","placeholder","Nombre",1,"form-control"],["class","text-danger",4,"ngIf"],["for","description",1,"form-label"],["id","description","autocomplete","description","formControlName","description","placeholder","Descripci\xf3n","rows","3",1,"form-control"],[1,"col-12","col-sm-6","mb-3"],["for","status",1,"form-label"],["id","status","autocomplete","status","formControlName","status","placeholder","Estado",1,"form-control"],["value",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["for","file",1,"form-label"],["type","file","id","file","autocomplete","file","formControlName","file","placeholder","file",1,"form-control",3,"change"],[1,"col-12","text-center"],[1,"btn","btn-success",3,"click"],[1,"button_label"],[1,"text-danger"],[3,"value"],["for","topic",1,"form-label"],["id","topic","autocomplete","topic","formControlName","topic","placeholder","Tema",1,"form-control"],["alt","",1,"mb-3",2,"width","200px",3,"src"],["width","200px","controls","",1,"mb-3"],["type","video/mp4",3,"src"]],template:function(t,i){if(1&t&&(e.YNc(0,E,3,0,"ng-container",0),e.YNc(1,O,2,0,"ng-template",null,1,e.W1O),e.TgZ(3,"form",2)(4,"div",3)(5,"label",4),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",5),e.YNc(8,Y,2,0,"p",6),e.qZA(),e.TgZ(9,"div",3)(10,"label",7),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"textarea",8),e._uU(13,"        "),e.qZA(),e.YNc(14,B,2,0,"p",6),e.qZA(),e.TgZ(15,"div",9)(16,"label",10),e._uU(17,"Estado"),e.qZA(),e.TgZ(18,"select",11)(19,"option",12),e._uU(20,"Selecciona el status"),e.qZA(),e.YNc(21,M,3,2,"ng-container",13),e.qZA(),e.YNc(22,L,2,0,"p",6),e.qZA(),e.YNc(23,G,10,2,"ng-container",14),e.TgZ(24,"div",9),e.YNc(25,P,4,2,"ng-container",14),e.TgZ(26,"label",15),e._uU(27,"Archivo (imagen o video)"),e.qZA(),e.TgZ(28,"input",16),e.NdJ("change",function(a){return i.onFileChange(a)}),e.qZA(),e.YNc(29,K,2,0,"p",6),e.qZA(),e.TgZ(30,"div",17)(31,"button",18),e.NdJ("click",function(){return i.validate()}),e.TgZ(32,"span",19),e._uU(33," Guardar "),e.qZA()()()()),2&t){const c=e.MAs(2);let a,s,p,l;e.Q6J("ngIf",i.resourceType===i.resourceTypeEnum.TOPIC)("ngIfElse",c),e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(5),e.Q6J("ngIf",(null==(a=i.form.get("name"))?null:a.invalid)&&((null==(a=i.form.get("name"))?null:a.dirty)||(null==(a=i.form.get("name"))?null:a.touched))),e.xp6(6),e.Q6J("ngIf",(null==(s=i.form.get("description"))?null:s.invalid)&&((null==(s=i.form.get("description"))?null:s.dirty)||(null==(s=i.form.get("description"))?null:s.touched))),e.xp6(7),e.Q6J("ngForOf",i.statusList),e.xp6(1),e.Q6J("ngIf",(null==(p=i.form.get("status"))?null:p.invalid)&&((null==(p=i.form.get("status"))?null:p.dirty)||(null==(p=i.form.get("status"))?null:p.touched))),e.xp6(1),e.Q6J("ngIf",i.resourceType===i.resourceTypeEnum.SUBTOPIC),e.xp6(2),e.Q6J("ngIf",i.file),e.xp6(4),e.Q6J("ngIf",(null==(l=i.form.get("file"))?null:l.invalid)&&((null==(l=i.form.get("file"))?null:l.dirty)||(null==(l=i.form.get("file"))?null:l.touched)))}},dependencies:[m.sg,m.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u],encapsulation:2}),n})();_(7651);const j_markFormGroupAsTouched=function q(n){Object.keys(n.controls).map(o=>n.controls[o]).forEach(o=>{o.markAsTouched(),o.controls&&q(o)})};var w=_(9949);function z(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"img",10),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.topic.files,e.LSH)}}function W(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"video",11),e._UZ(2,"source",12),e._uU(3," Tu navegador no admite la reproducci\xf3n de video. "),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("src",t.topic.files,e.LSH)}}function $(n,o){if(1&n&&(e.ynx(0),e.YNc(1,z,2,1,"ng-container",0),e.YNc(2,W,4,1,"ng-container",0),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.IMAGE),e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.VIDEO)}}function X(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13)(2,"button",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.generateQuestions())}),e._uU(3,"Generar preguntas"),e.qZA()(),e.BQk()}}function ee(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13)(2,"button",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.createQuestions())}),e._uU(3,"Crear preguntas"),e.qZA()(),e.TgZ(4,"div",13)(5,"button",15),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.detete())}),e._uU(6,"Eliminar"),e.qZA()(),e.TgZ(7,"div",13)(8,"button",16),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.edit())}),e._uU(9,"Actualizar"),e.qZA()(),e.BQk()}}function te(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"li")(2,"a",18),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"slice"),e.qZA()(),e.BQk()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("routerLink","/topics/subtopic-show/"+t._id),e.xp6(1),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description.length>50?e.Dn7(6,3,t.description,0,50)+"...":t.description)}}function ne(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2,"Subtemas"),e.qZA(),e.TgZ(3,"ul"),e.YNc(4,te,7,7,"ng-container",17),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",t.topic.subtopics)}}function ie(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,$,3,2,"ng-container",0),e.TgZ(5,"div",4)(6,"h5",5),e._uU(7),e.qZA(),e.TgZ(8,"p",6),e._uU(9),e.qZA(),e.YNc(10,X,4,0,"ng-container",0),e.YNc(11,ee,10,0,"ng-container",0),e.qZA(),e.TgZ(12,"div",7)(13,"small",8),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"small",8),e._uU(17),e.ALo(18,"date"),e.qZA()()()(),e.TgZ(19,"div",9),e.YNc(20,ne,5,1,"ng-container",0),e.qZA()(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.topic.files),e.xp6(3),e.Oqu(t.topic.name),e.xp6(2),e.Oqu(t.topic.description),e.xp6(1),e.Q6J("ngIf",!t.isAdmin),e.xp6(1),e.Q6J("ngIf",t.isAdmin),e.xp6(3),e.hij("Creado el: ",e.xi3(15,8,t.topic.createdAt,"dd/MM/yyyy")," y "),e.xp6(3),e.hij("actualizado el: ",e.xi3(18,11,t.topic.updatedAt,"dd/MM/yyyy"),""),e.xp6(3),e.Q6J("ngIf",t.topic.subtopics.length)}}function oe(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"img",10),e.BQk()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("src",t.subtopic.files,e.LSH)}}function re(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"video",11),e._UZ(2,"source",12),e._uU(3," Tu navegador no admite la reproducci\xf3n de video. "),e.qZA(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(2),e.Q6J("src",t.subtopic.files,e.LSH)}}function ce(n,o){if(1&n&&(e.ynx(0),e.YNc(1,oe,2,1,"ng-container",0),e.YNc(2,re,4,1,"ng-container",0),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.IMAGE),e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.VIDEO)}}function se(n,o){if(1&n&&(e.ynx(0),e.YNc(1,ce,3,2,"ng-container",0),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.subtopic.files)}}function ae(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13)(2,"button",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.generateQuestions())}),e._uU(3,"Generar preguntas"),e.qZA()(),e.BQk()}}function pe(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13)(2,"button",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.createQuestions())}),e._uU(3,"Crear preguntas"),e.qZA()(),e.TgZ(4,"div",13)(5,"button",15),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.detete())}),e._uU(6,"Eliminar"),e.qZA()(),e.TgZ(7,"div",13)(8,"button",16),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.edit())}),e._uU(9,"Actualizar"),e.qZA()(),e.BQk()}}function ue(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,se,2,1,"ng-container",0),e.TgZ(5,"div",4)(6,"h5",5),e._uU(7),e.qZA(),e.TgZ(8,"p",6),e._uU(9),e.qZA(),e.YNc(10,ae,4,0,"ng-container",0),e.YNc(11,pe,10,0,"ng-container",0),e.qZA(),e.TgZ(12,"div",7)(13,"small",8),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"small",8),e._uU(17),e.ALo(18,"date"),e.qZA()()()(),e.TgZ(19,"div",9)(20,"h2"),e._uU(21,"Tema"),e.qZA(),e.TgZ(22,"ul")(23,"li")(24,"a",18),e._uU(25),e.qZA(),e.TgZ(26,"p"),e._uU(27),e.ALo(28,"slice"),e.qZA()()()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.subtopic.files),e.xp6(3),e.Oqu(t.subtopic.name),e.xp6(2),e.Oqu(t.subtopic.description),e.xp6(1),e.Q6J("ngIf",!t.isAdmin),e.xp6(1),e.Q6J("ngIf",t.isAdmin),e.xp6(3),e.hij("Creado el: ",e.xi3(15,10,t.subtopic.createdAt,"dd/MM/yyyy")," y "),e.xp6(3),e.hij("actualizado el: ",e.xi3(18,13,t.subtopic.updatedAt,"dd/MM/yyyy"),""),e.xp6(7),e.Q6J("routerLink","/topics/topic-show/"+t.subtopic.topic._id),e.xp6(1),e.Oqu(t.subtopic.topic.name),e.xp6(2),e.Oqu(t.subtopic.topic.description.length>50?e.Dn7(28,16,t.subtopic.topic.description,0,50)+"...":t.subtopic.topic.description)}}function le(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",13)(2,"a",27),e._uU(3,"Ver pregunta"),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("routerLink","/questions/question-show/"+t.get("_id").value)}}function _e(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",28)(2,"div",25)(3,"input",29),e.NdJ("input",function(){const a=e.CHM(t).$implicit,s=e.oxw().$implicit;return e.KtG(s.get("selectedAnswer").setValue(a.get("_id").value))}),e.qZA(),e.TgZ(4,"label",30),e._uU(5),e.qZA()()(),e.BQk()}if(2&n){const t=o.$implicit,i=e.oxw().index;e.xp6(2),e.Q6J("formGroup",t),e.xp6(1),e.Q6J("id",t.get("_id").value),e.uIk("name","answer"+i),e.xp6(1),e.Q6J("for",t.get("_id").value),e.xp6(1),e.hij(" ",t.get("description").value," ")}}function me(n,o){1&n&&(e.TgZ(0,"p",31),e._uU(1,"Selecciona una respuesta"),e.qZA())}function de(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",24)(2,"div",25)(3,"p"),e._uU(4),e.qZA(),e.YNc(5,le,4,1,"ng-container",0),e.YNc(6,_e,6,5,"ng-container",17),e.YNc(7,me,2,0,"p",26),e.qZA()(),e.BQk()),2&n){const t=o.$implicit,i=e.oxw(2);let c;e.xp6(2),e.Q6J("formGroup",t),e.xp6(2),e.Oqu(t.get("description").value),e.xp6(1),e.Q6J("ngIf",i.isAdmin),e.xp6(1),e.Q6J("ngForOf",t.get("answers").controls),e.xp6(1),e.Q6J("ngIf",(null==(c=t.get("selectedAnswer"))?null:c.invalid)&&((null==(c=t.get("selectedAnswer"))?null:c.dirty)||(null==(c=t.get("selectedAnswer"))?null:c.touched)))}}function ge(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"div",4)(3,"form",20),e.YNc(4,de,8,5,"ng-container",17),e.TgZ(5,"div",21)(6,"button",22),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.validate())}),e.TgZ(7,"span",23),e._uU(8," Enviar "),e.qZA()()()()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("formGroup",t.questionsForm),e.xp6(1),e.Q6J("ngForOf",t.questionsForm.controls)}}function fe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"li"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(2),e.AsE(" ",t.question.description," es ",t.isCorrect?"correcta":"incorrecta"," ")}}function Te(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"div",4)(3,"ul"),e.YNc(4,fe,3,2,"ng-container",17),e.qZA(),e.TgZ(5,"button",32)(6,"span",33),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.regenerateQuestions())}),e._uU(7," Volver a generar preguntas "),e.qZA()()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.summarySolvedQuestions)}}let y=(()=>{class n{constructor(t,i,c,a,s,p,l){this.authenticatedService=t,this.topicHttpService=i,this.questionHttpService=c,this.mediaService=a,this.router=s,this.route=p,this.fb=l,this.mediaTypeEnum=u,this.resourceType=T._.TOPIC,this.resourceId="",this.topic=void 0,this.subtopic=void 0,this.questions=[],this.isAdmin=!1,this.questionsForm=new r.Oe([]),this.summarySolvedQuestions=[],this.mediaType=this.mediaTypeEnum.UNKNOWN}ngOnInit(){this.internalInit()}generateQuestions(){this.topic&&this.getQuestionsByTopic(),this.subtopic&&this.getQuestionsBySubtopic()}detete(){window.confirm("\xbfEst\xe1s seguro de que lo desea eliminar?")&&this.topicHttpService.deleteResourceById(this.resourceId,this.resourceType).subscribe({next:t=>{alert(t.data.name+" eliminado correctamente"),this.router.navigate(["/topics"])},error:t=>console.error(t)})}edit(){this.router.navigate(this.resourceType===T._.TOPIC?["/topics/topic-edit/"+this.resourceId]:["/topics/subtopic-edit/"+this.resourceId])}createQuestions(){this.router.navigate(["/questions/question-create"],{queryParams:{resourceId:this.resourceId,resourceType:this.resourceType}})}validate(){j_markFormGroupAsTouched(this.questionsForm),this.questionsForm.valid&&this.buildAnswersSummary()}regenerateQuestions(){this.summarySolvedQuestions=[],this.buildQuestionsForm()}buildAnswersSummary(){this.summarySolvedQuestions=[],this.questionsForm.value.forEach(t=>{const i=this.questions.find(s=>s._id===t._id),c=i?.answers.find(s=>s._id===t.selectedAnswer),a=i?.answers.some(s=>s._id===t.selectedAnswer&&s.isCorrect);this.summarySolvedQuestions.push({question:i,isCorrect:a,selectedAnswer:c,correctAnswer:i?.answers.find(s=>s.isCorrect)})}),this.questionsForm=new r.Oe([])}getQuestionsByTopic(){this.questionHttpService.getQuestionsByTopic(this.topic._id).subscribe({next:t=>{this.questions=t.data,this.buildQuestionsForm()},error:t=>{console.error(t)}})}getOrderQuestionsRandomly(){return this.questions.sort(()=>Math.random()-.5)}buildQuestionsForm(){this.questionsForm=new r.Oe([]),this.getOrderQuestionsRandomly().forEach(i=>{const c=new r.cw({_id:new r.NI(i._id,[]),description:new r.NI(i.description,[]),selectedAnswer:new r.NI("",[r.kI.required])}),a=new r.Oe([]);i.answers.forEach(s=>{const p=new r.cw({_id:new r.NI(s._id,[]),description:new r.NI(s.description,[])});a.push(p)}),c.addControl("answers",a),this.questionsForm.push(c)})}getQuestionsBySubtopic(){this.questionHttpService.getQuestionsBySubtopic(this.subtopic._id).subscribe({next:t=>{this.questions=t.data},error:t=>{console.log(t)}})}internalInit(){this.setIsAdmin(),this.setResourceType(),this.subscribeToParams()}setResourceType(){this.resourceType=this.router.url.split("/")[2].split("-")[0]}subscribeToParams(){this.route.params.subscribe(t=>{this.resourceId=t.id,this.getResourceById()})}setIsAdmin(){this.isAdmin=this.authenticatedService.hasRole([d.F.ADMIN])}handleGenerateQuestions(){this.isAdmin&&this.generateQuestions()}getResourceById(){this.topicHttpService.getResourceById(this.resourceId,this.resourceType).subscribe({next:t=>{this.handleGetResourceById(t),this.handleGenerateQuestions()},error:t=>{console.log(t)}})}getVisualizationType(t){return t.data.files.startsWith("data:image")?"image":t.data.files.startsWith("data:video")?"video":"otro"}handleGetResourceById(t){this.mediaType=this.mediaService.getMediaTypeFromBase64(t.data.files),this.resourceType===T._.TOPIC?this.topic=t.data:this.subtopic=t.data}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(A.c),e.Y36(C.J),e.Y36(w.Q),e.Y36(x),e.Y36(g.F0),e.Y36(g.gz),e.Y36(r.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["topic-show-container"]],decls:4,vars:4,consts:[[4,"ngIf"],[1,"row","mb-3"],[1,"col-12","col-sm-8"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"card-footer"],[1,"text-body-secondary"],[1,"col-12","col-sm-4"],["alt","",1,"card-img-top",3,"src"],["width","100%","controls",""],["type","video/mp4",3,"src"],[1,"mb-3"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-warning",3,"click"],[4,"ngFor","ngForOf"],[3,"routerLink"],[1,"card","mb-3"],[1,"row",3,"formGroup"],[1,"col-12","text-center"],[1,"btn","btn-success",3,"click"],[1,"button_label"],[1,"col-12","mb-3"],[3,"formGroup"],["class","text-danger",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],[1,"form-check"],["type","radio",1,"form-check-input",3,"id","input"],[1,"form-check-label",3,"for"],[1,"text-danger"],[1,"btn","btn-success"],[1,"button_label",3,"click"]],template:function(t,i){1&t&&(e.YNc(0,ie,21,14,"ng-container",0),e.YNc(1,ue,29,20,"ng-container",0),e.YNc(2,ge,9,2,"ng-container",0),e.YNc(3,Te,8,1,"ng-container",0)),2&t&&(e.Q6J("ngIf",i.topic),e.xp6(1),e.Q6J("ngIf",i.subtopic),e.xp6(1),e.Q6J("ngIf",i.questionsForm&&i.questionsForm.controls.length),e.xp6(1),e.Q6J("ngIf",i.summarySolvedQuestions.length))},dependencies:[m.sg,m.O5,r._Y,r.JL,r.sg,g.rH,m.OU,m.uU],encapsulation:2}),n})();var h=_(4722);function he(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2,"Actualizar tema"),e.qZA(),e.BQk())}function Ce(n,o){1&n&&(e.TgZ(0,"h1"),e._uU(1,"Actualizar subtema"),e.qZA())}function xe(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1,"Ingresa el nombre"),e.qZA())}function Ze(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1," Ingresa la descripci\xf3n"),e.qZA())}function ye(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"option",20),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function ve(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1,"Selectiona el estado"),e.qZA())}function be(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"option",20),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function Ae(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1,"Selectiona el tema"),e.qZA())}function Ie(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",9)(2,"label",21),e._uU(3,"Tema"),e.qZA(),e.TgZ(4,"select",22),e.YNc(5,be,3,2,"ng-container",12),e.qZA(),e.YNc(6,Ae,2,0,"p",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();let i;e.xp6(5),e.Q6J("ngForOf",t.topics),e.xp6(1),e.Q6J("ngIf",(null==(i=t.form.get("topic"))?null:i.invalid)&&((null==(i=t.form.get("topic"))?null:i.dirty)||(null==(i=t.form.get("topic"))?null:i.touched)))}}function qe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"small"),e._uU(2,"Imagen del tema"),e.qZA(),e._UZ(3,"br")(4,"img",23),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("src",t.topic.files,e.LSH)}}function Qe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"small"),e._uU(2,"Video del tema"),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"video",24),e._UZ(5,"source",25),e._uU(6," Tu navegador no admite la reproducci\xf3n de video. "),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("src",t.topic.files,e.LSH)}}function we(n,o){if(1&n&&(e.ynx(0),e.YNc(1,qe,5,1,"ng-container",13),e.YNc(2,Qe,7,1,"ng-container",13),e._UZ(3,"br"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.IMAGE),e.xp6(1),e.Q6J("ngIf",t.mediaType===t.mediaTypeEnum.VIDEO)}}function Ne(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"small"),e._uU(2,"Nueva imagen del tema"),e.qZA(),e._UZ(3,"br")(4,"img",23),e.BQk()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("src",t.file,e.LSH)}}function Se(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"small"),e._uU(2,"Nuevo video del tema"),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"video",24),e._UZ(5,"source",25),e._uU(6," Tu navegador no admite la reproducci\xf3n de video. "),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("src",t.file,e.LSH)}}function Ue(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Ne,5,1,"ng-container",13),e.YNc(2,Se,7,1,"ng-container",13),e._UZ(3,"br"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.fileMediaType===t.mediaTypeEnum.IMAGE),e.xp6(1),e.Q6J("ngIf",t.fileMediaType===t.mediaTypeEnum.VIDEO)}}function Je(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1," Selecciona el archivo"),e.qZA())}let v=(()=>{class n{constructor(t,i,c,a){this.topicHttpService=t,this.mediaService=i,this.router=c,this.route=a,this.mediaTypeEnum=u,this.resourceTypeEnum=T._,this.form=new r.cw({}),this.topic=void 0,this.subtopic=void 0,this.resourceType=T._.TOPIC,this.resourceId="",this.topics=[],this.statusList=[],this.file="",this.mediaType=u.UNKNOWN,this.fileMediaType=u.UNKNOWN}ngOnInit(){this.internalInit()}validate(){this.form.valid?this.update():alert("form invalid")}onFileChange(t){t.target.files&&t.target.files.length>0&&this.convertToBase64(t.target.files[0])}convertToBase64(t){const i=new FileReader;i.onload=()=>{this.file=i.result,this.fileMediaType=this.mediaService.getMediaTypeFromBase64(this.file)},i.readAsDataURL(t)}internalInit(){this.setStatusList(),this.setResourceType(),this.setResourceId(),this.buildForm()}setStatusList(){this.statusList=[],Object.values(f).forEach(t=>{this.statusList.push(t)})}setResourceType(){this.resourceType=this.router.url.split("/")[2].split("-")[0]}setResourceId(){this.route.params.subscribe(t=>{this.resourceId=t.id,this.getResourceById()})}getResourceById(){this.topicHttpService.getResourceById(this.resourceId,this.resourceType).subscribe({next:t=>{this.mediaType=this.mediaService.getMediaTypeFromBase64(t.data.files),this.resourceType===T._.TOPIC?this.topic=t.data:this.subtopic=t.data,this.retrieveTopics(),this.setFormValues()},error:t=>{console.log(t)}})}retrieveTopics(){this.resourceType===this.resourceTypeEnum.SUBTOPIC&&this.topicHttpService.retrieveTopics().subscribe({next:t=>{this.topics=t.data},error:t=>{console.error(t)}})}buildForm(){this.form=new r.cw({name:new r.NI("",[r.kI.required]),description:new r.NI("",[r.kI.required]),status:new r.NI("",[r.kI.required]),file:new r.NI("",[])}),this.resourceType===this.resourceTypeEnum.SUBTOPIC&&this.form.addControl("topic",new r.NI("",[r.kI.required]))}setFormValues(){const t=this.topic||this.subtopic;this.form.get("name")?.setValue(t.name),this.form.get("description")?.setValue(t.description),this.form.get("status")?.setValue(t.status),this.resourceType===this.resourceTypeEnum.SUBTOPIC&&this.form.get("topic")?.setValue(this.subtopic.topic?._id)}buildRequest(){return{...this.form.value,files:this.file?this.file:this.topic.files}}update(){const t=this.buildRequest();this.topicHttpService.updateResource(t,this.resourceType,this.resourceId).subscribe({next:i=>{i.success&&alert("Actualizado correctamente"),this.router.navigate(["/topics"])},error:i=>{console.log("err",i)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.J),e.Y36(x),e.Y36(g.F0),e.Y36(g.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["topic-edit-container"]],decls:33,vars:11,consts:[[4,"ngIf","ngIfElse"],["subtopicTemplate",""],[1,"row",3,"formGroup"],[1,"col-12","mb-3"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","placeholder","Nombre",1,"form-control"],["class","text-danger",4,"ngIf"],["for","description",1,"form-label"],["id","description","autocomplete","description","formControlName","description","placeholder","Descripci\xf3n","rows","3",1,"form-control"],[1,"col-12","col-sm-6","mb-3"],["for","status",1,"form-label"],["id","status","autocomplete","status","formControlName","status","placeholder","status",1,"form-control"],[4,"ngFor","ngForOf"],[4,"ngIf"],["for","file",1,"form-label"],["type","file","id","file","autocomplete","file","formControlName","file","placeholder","file",1,"form-control",3,"change"],[1,"col-12","text-center"],[1,"btn","btn-success",3,"click"],[1,"button_label"],[1,"text-danger"],[3,"value"],["for","topic",1,"form-label"],["id","topic","autocomplete","topic","formControlName","topic","placeholder","topics",1,"form-control"],["alt","",1,"mb-3",2,"width","200px",3,"src"],["width","200px","controls","",1,"mb-3"],["type","video/mp4",3,"src"]],template:function(t,i){if(1&t&&(e.YNc(0,he,3,0,"ng-container",0),e.YNc(1,Ce,2,0,"ng-template",null,1,e.W1O),e.TgZ(3,"form",2)(4,"div",3)(5,"label",4),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",5),e.YNc(8,xe,2,0,"p",6),e.qZA(),e.TgZ(9,"div",3)(10,"label",7),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"textarea",8),e._uU(13,"        "),e.qZA(),e.YNc(14,Ze,2,0,"p",6),e.qZA(),e.TgZ(15,"div",9)(16,"label",10),e._uU(17,"Estado"),e.qZA(),e.TgZ(18,"select",11),e.YNc(19,ye,3,2,"ng-container",12),e.qZA(),e.YNc(20,ve,2,0,"p",6),e.qZA(),e.YNc(21,Ie,7,2,"ng-container",13),e.TgZ(22,"div",9),e.YNc(23,we,4,2,"ng-container",13),e.YNc(24,Ue,4,2,"ng-container",13),e.TgZ(25,"label",14),e._uU(26,"Archivo (imagen o video)"),e.qZA(),e.TgZ(27,"input",15),e.NdJ("change",function(a){return i.onFileChange(a)}),e.qZA(),e.YNc(28,Je,2,0,"p",6),e.qZA(),e.TgZ(29,"div",16)(30,"button",17),e.NdJ("click",function(){return i.validate()}),e.TgZ(31,"span",18),e._uU(32," Actualizar "),e.qZA()()()()),2&t){const c=e.MAs(2);let a,s,p,l;e.Q6J("ngIf",i.resourceType===i.resourceTypeEnum.TOPIC)("ngIfElse",c),e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(5),e.Q6J("ngIf",(null==(a=i.form.get("name"))?null:a.invalid)&&((null==(a=i.form.get("name"))?null:a.dirty)||(null==(a=i.form.get("name"))?null:a.touched))),e.xp6(6),e.Q6J("ngIf",(null==(s=i.form.get("description"))?null:s.invalid)&&((null==(s=i.form.get("description"))?null:s.dirty)||(null==(s=i.form.get("description"))?null:s.touched))),e.xp6(5),e.Q6J("ngForOf",i.statusList),e.xp6(1),e.Q6J("ngIf",(null==(p=i.form.get("status"))?null:p.invalid)&&((null==(p=i.form.get("status"))?null:p.dirty)||(null==(p=i.form.get("status"))?null:p.touched))),e.xp6(1),e.Q6J("ngIf",i.resourceType===i.resourceTypeEnum.SUBTOPIC),e.xp6(2),e.Q6J("ngIf",i.topic&&i.topic.files),e.xp6(1),e.Q6J("ngIf",i.file),e.xp6(4),e.Q6J("ngIf",(null==(l=i.form.get("file"))?null:l.invalid)&&((null==(l=i.form.get("file"))?null:l.dirty)||(null==(l=i.form.get("file"))?null:l.touched)))}},dependencies:[m.sg,m.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u],encapsulation:2}),n})();const Fe=[{path:"",component:I,data:{roles:[d.F.USER,d.F.ADMIN]},canActivate:[h.a]},{path:"topic-create",component:Z,data:{roles:[d.F.ADMIN]},canActivate:[h.a]},{path:"subtopic-create",component:Z,data:{roles:[d.F.ADMIN]},canActivate:[h.a]},{path:"topic-show/:id",component:y,data:{roles:[d.F.USER,d.F.ADMIN]},canActivate:[h.a]},{path:"subtopic-show/:id",component:y,data:{roles:[d.F.USER,d.F.ADMIN]},canActivate:[h.a]},{path:"topic-edit/:id",component:v,data:{roles:[d.F.ADMIN]},canActivate:[h.a]},{path:"subtopic-edit/:id",component:v,data:{roles:[d.F.ADMIN]},canActivate:[h.a]}];let ke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(Fe),g.Bz]}),n})(),Ee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[{provide:"components",useValue:[I,Z,y,v],multi:!0},C.J,w.Q],imports:[m.ez,r.UX,ke]}),n})()}}]);